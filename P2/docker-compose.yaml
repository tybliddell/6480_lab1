version: '3'

services:
  host-a:
    tty: true
    privileged: true
    #command: sh -c "route add -net 10.0.15.0/24 gw 10.0.14.4 && bash"
    build: .
    networks:
      host-a-r1:
        ipv4_address: 10.0.10.3
  r1:
    tty: true
    build: .
    networks:
      host-a-r1:
        ipv4_address: 10.0.10.4
      r1-r2:
        ipv4_address: 10.0.11.3
      r1-r4:
        ipv4_address: 10.0.12.3
  r2:
    tty: true
    build: .
    networks: 
      r1-r2:
        ipv4_address: 10.0.11.4
      r2-r3:
        ipv4_address: 10.0.13.3
  r3:
    tty: true
    build: .
    networks:
      r2-r3:
        ipv4_address: 10.0.13.4
      r4-r3:
        ipv4_address: 10.0.14.4
      r3-host-b:
        ipv4_address: 10.0.15.3
  r4:
    tty: true
    build: .
    networks:
      r1-r4:
        ipv4_address: 10.0.12.4
      r4-r3:
        ipv4_address: 10.0.14.3
  host-b:
    tty: true
    privileged: true
    #command: sh -c "route add -net 10.0.14.0/24 gw 10.0.15.4 && bash"
    build: .
    networks:
      r3-host-b:
       ipv4_address: 10.0.15.4


networks:
  host-a-r1:
    ipam:
      config:
        - subnet: 10.0.10.0/24
  r1-r2:
    ipam:
      config:
        - subnet: 10.0.11.0/24
  r1-r4:
    ipam:
      config:
        - subnet: 10.0.12.0/24
  r2-r3:
    ipam:
      config:
        - subnet: 10.0.13.0/24
  r4-r3:
    ipam:
      config:
        - subnet: 10.0.14.0/24
  r3-host-b:
    ipam:
      config:
        - subnet: 10.0.15.0/24